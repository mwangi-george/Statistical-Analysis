<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Mwangi George">
<meta name="dcterms.date" content="2023-02-18">
<meta name="description" content="A Supervised machine learning technique">

<title>Logistic Regression Classifier</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="Logistic-Regression-classifier_files/libs/clipboard/clipboard.min.js"></script>
<script src="Logistic-Regression-classifier_files/libs/quarto-html/quarto.js"></script>
<script src="Logistic-Regression-classifier_files/libs/quarto-html/popper.min.js"></script>
<script src="Logistic-Regression-classifier_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Logistic-Regression-classifier_files/libs/quarto-html/anchor.min.js"></script>
<link href="Logistic-Regression-classifier_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Logistic-Regression-classifier_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Logistic-Regression-classifier_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Logistic-Regression-classifier_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Logistic-Regression-classifier_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Logistic Regression Classifier</h1>
                  <div>
        <div class="description">
          A Supervised machine learning technique
        </div>
      </div>
                </div>
  </div>
    
  <div class="quarto-title-meta-author">
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-heading">Affiliation</div>
    
      <div class="quarto-title-meta-contents">
      <a href="https://twitter.com/mwangi__george">Mwangi George</a> 
    </div>
      <div class="quarto-title-meta-contents">
          <p class="affiliation">
              College of Economics and Business, Kenyatta University
            </p>
        </div>
      </div>

  <div class="quarto-title-meta">

        
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">February 18, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">



<nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction"><span class="toc-section-number">1</span>  Introduction</a></li>
  <li><a href="#data-and-data-preparation" id="toc-data-and-data-preparation"><span class="toc-section-number">2</span>  Data and Data Preparation</a></li>
  <li><a href="#exploratory-analysis" id="toc-exploratory-analysis"><span class="toc-section-number">3</span>  Exploratory analysis</a></li>
  </ul>
</nav>
<section id="introduction" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">1</span> Introduction</h2>
<p>In its most basic form, regression involves predicting an outcome <code>y</code> using one or more predictors, labeled as <code>x</code> variables.</p>
<p>Logistic Regression is a type of regression applied when the response variable is logical, i.e takes two outcomes, like yes or no. A type of S-shaped curve called logistic function has the property that for any input value of <code>x</code> , the output is always between 0 and 1, just like a probability. The greater this probability, the more likely the outcome is to be labeled 1.</p>
</section>
<section id="data-and-data-preparation" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="data-and-data-preparation"><span class="header-section-number">2</span> Data and Data Preparation</h2>
<p>For this, article, we are going to use mobile money data containing services and experience of mobile money customers from three districts of Kenya. Our target variable is <code>mm_account_cancelled</code>, a feature indicating whether someone cancelled their mobile money account based on other features in the dataset.</p>
<p>Let’s start by reading the data from disk into R’s global environment.</p>
<div class="cell">

</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load data</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>mobile_m_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"datasets/mobile_money_data.csv"</span>, <span class="at">show_col_types =</span> F) <span class="sc">%&gt;%</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># clean variable names</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># remove unnecessary variables</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(start_time, end_time))</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># print dataset structure</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(mobile_m_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2442   27</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mobile_m_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 1%">
<col style="width: 4%">
<col style="width: 5%">
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 4%">
<col style="width: 9%">
<col style="width: 8%">
<col style="width: 4%">
<col style="width: 3%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 1%">
<col style="width: 4%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">hhid</th>
<th style="text-align: right;">account_num</th>
<th style="text-align: left;">account_type</th>
<th style="text-align: right;">weight</th>
<th style="text-align: left;">district</th>
<th style="text-align: left;">urban</th>
<th style="text-align: left;">gender</th>
<th style="text-align: right;">age</th>
<th style="text-align: right;">hh_members</th>
<th style="text-align: left;">highest_grade_completed</th>
<th style="text-align: left;">mm_account_cancelled</th>
<th style="text-align: left;">prefer_cash</th>
<th style="text-align: left;">mm_trust</th>
<th style="text-align: left;">mm_account_telco</th>
<th style="text-align: left;">mm_account_telco_main</th>
<th style="text-align: left;">v234</th>
<th style="text-align: left;">agent_trust</th>
<th style="text-align: left;">v236</th>
<th style="text-align: left;">v237</th>
<th style="text-align: left;">v238</th>
<th style="text-align: left;">v240</th>
<th style="text-align: left;">v241</th>
<th style="text-align: left;">v242</th>
<th style="text-align: left;">v243</th>
<th style="text-align: left;">v244</th>
<th style="text-align: left;">v245</th>
<th style="text-align: left;">v246</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1001</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Mobile Money</td>
<td style="text-align: right;">145.9444</td>
<td style="text-align: left;">District_A</td>
<td style="text-align: left;">Urban</td>
<td style="text-align: left;">male</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">primary 6</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">Company_A Company_B</td>
<td style="text-align: left;">Company_A</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">no</td>
</tr>
<tr class="even">
<td style="text-align: right;">1001</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Bank Account</td>
<td style="text-align: right;">145.9444</td>
<td style="text-align: left;">District_A</td>
<td style="text-align: left;">Urban</td>
<td style="text-align: left;">male</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">primary 6</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">Company_A Company_B</td>
<td style="text-align: left;">Company_A</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">no</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1001</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">VSLA Account</td>
<td style="text-align: right;">145.9444</td>
<td style="text-align: left;">District_A</td>
<td style="text-align: left;">Urban</td>
<td style="text-align: left;">male</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">primary 6</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">Company_A Company_B</td>
<td style="text-align: left;">Company_A</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">no</td>
</tr>
<tr class="even">
<td style="text-align: right;">1002</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">SACCO Account</td>
<td style="text-align: right;">122.9067</td>
<td style="text-align: left;">District_B</td>
<td style="text-align: left;">Rural</td>
<td style="text-align: left;">male</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">primary 3</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">no</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1002</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">VSLA Account</td>
<td style="text-align: right;">122.9067</td>
<td style="text-align: left;">District_B</td>
<td style="text-align: left;">Rural</td>
<td style="text-align: left;">male</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">primary 3</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">no</td>
</tr>
<tr class="even">
<td style="text-align: right;">1003</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Mobile Money</td>
<td style="text-align: right;">760.4619</td>
<td style="text-align: left;">District_A</td>
<td style="text-align: left;">Urban</td>
<td style="text-align: left;">male</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">8</td>
<td style="text-align: left;">secondary 6</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">Company_A</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">no</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>The dataset contains 2442 observations and 27 variables. However, it seems that during the survey, participants listed all the different types of financial accounts that they had registered, resulting in a dataset where the format is one observation per account type instead of one observation per participant. This is evident in the repetition of the household id column. We need to clean the data to remove this format.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># data formating</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>mobile_data <span class="ot">&lt;-</span> mobile_m_data <span class="sc">%&gt;%</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># select variables to pivot</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(hhid, account_num, account_type) <span class="sc">%&gt;%</span> </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># spread to wider format</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> account_num, </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> account_type, </span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_prefix =</span> <span class="st">"account_"</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># join with original dataset</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> mobile_m_data <span class="sc">%&gt;%</span> </span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(account_num, account_type), <span class="at">location =</span> urban) <span class="sc">%&gt;%</span> </span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">distinct</span>(), </span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="st">"hhid"</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mobile_m_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 1%">
<col style="width: 4%">
<col style="width: 5%">
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 4%">
<col style="width: 9%">
<col style="width: 8%">
<col style="width: 4%">
<col style="width: 3%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 1%">
<col style="width: 4%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">hhid</th>
<th style="text-align: right;">account_num</th>
<th style="text-align: left;">account_type</th>
<th style="text-align: right;">weight</th>
<th style="text-align: left;">district</th>
<th style="text-align: left;">urban</th>
<th style="text-align: left;">gender</th>
<th style="text-align: right;">age</th>
<th style="text-align: right;">hh_members</th>
<th style="text-align: left;">highest_grade_completed</th>
<th style="text-align: left;">mm_account_cancelled</th>
<th style="text-align: left;">prefer_cash</th>
<th style="text-align: left;">mm_trust</th>
<th style="text-align: left;">mm_account_telco</th>
<th style="text-align: left;">mm_account_telco_main</th>
<th style="text-align: left;">v234</th>
<th style="text-align: left;">agent_trust</th>
<th style="text-align: left;">v236</th>
<th style="text-align: left;">v237</th>
<th style="text-align: left;">v238</th>
<th style="text-align: left;">v240</th>
<th style="text-align: left;">v241</th>
<th style="text-align: left;">v242</th>
<th style="text-align: left;">v243</th>
<th style="text-align: left;">v244</th>
<th style="text-align: left;">v245</th>
<th style="text-align: left;">v246</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1001</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Mobile Money</td>
<td style="text-align: right;">145.9444</td>
<td style="text-align: left;">District_A</td>
<td style="text-align: left;">Urban</td>
<td style="text-align: left;">male</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">primary 6</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">Company_A Company_B</td>
<td style="text-align: left;">Company_A</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">no</td>
</tr>
<tr class="even">
<td style="text-align: right;">1001</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Bank Account</td>
<td style="text-align: right;">145.9444</td>
<td style="text-align: left;">District_A</td>
<td style="text-align: left;">Urban</td>
<td style="text-align: left;">male</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">primary 6</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">Company_A Company_B</td>
<td style="text-align: left;">Company_A</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">no</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1001</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">VSLA Account</td>
<td style="text-align: right;">145.9444</td>
<td style="text-align: left;">District_A</td>
<td style="text-align: left;">Urban</td>
<td style="text-align: left;">male</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">primary 6</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">Company_A Company_B</td>
<td style="text-align: left;">Company_A</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">no</td>
</tr>
<tr class="even">
<td style="text-align: right;">1002</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">SACCO Account</td>
<td style="text-align: right;">122.9067</td>
<td style="text-align: left;">District_B</td>
<td style="text-align: left;">Rural</td>
<td style="text-align: left;">male</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">primary 3</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">no</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1002</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">VSLA Account</td>
<td style="text-align: right;">122.9067</td>
<td style="text-align: left;">District_B</td>
<td style="text-align: left;">Rural</td>
<td style="text-align: left;">male</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">primary 3</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">no</td>
</tr>
<tr class="even">
<td style="text-align: right;">1003</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Mobile Money</td>
<td style="text-align: right;">760.4619</td>
<td style="text-align: left;">District_A</td>
<td style="text-align: left;">Urban</td>
<td style="text-align: left;">male</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">8</td>
<td style="text-align: left;">secondary 6</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">Company_A</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">no</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Now that we have achieved one observation per participant, we can move on to the next step.</p>
</section>
<section id="exploratory-analysis" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="exploratory-analysis"><span class="header-section-number">3</span> Exploratory analysis</h2>
<p>Before we try to model anything, it is always important to conduct some exploratory analysis and identify which features have a significant impact on our target outcome. However, for the purpose of staying on track, we will not do that here. Instead, We can hypothesize which features are likely to cause someone to cancel their mobile money account. Some of these include gender, age, location(whether urban or rural), mm_trust(whether they trust mobile money), district, and agent_trust(whether they trust mobile money agents). For simplicity, let’s narrow the list down to gender, age, location, and agent_trust.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># select important variables for modeling</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>model_data <span class="ot">&lt;-</span> mobile_data <span class="sc">%&gt;%</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(hhid, mm_account_cancelled, gender, age, location, agent_trust) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The variable agent_trust contains several missing values. By default, regression models exclude any observations with missing values on their predictors. We can therefore treat label the missing values in the agent trust variable as another category, <code>missing</code>.</p>
<div class="callout-important callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>Because records having missing data differ systematically from those without, a binary 1/0 missing value indicator can be added to model the fact that a value was imputed. Sometimes, this becomes one of the model’s most important predictors.</p>
</div>
</div>
<p>We should also format variables with categorical variables into there right data type, factor.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>model_data <span class="sc">%&gt;%</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># format variables</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># create missing data indicator variable</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">agent_trust_missing =</span> <span class="fu">if_else</span>(<span class="fu">is.na</span>(agent_trust), <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># treating NA's as a category</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">agent_trust =</span> <span class="fu">if_else</span>(<span class="fu">is.na</span>(agent_trust), <span class="st">"missing"</span>, agent_trust),</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># changes chr to factors </span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">mm_account_cancelled =</span> <span class="fu">factor</span>(</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>      mm_account_cancelled, </span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"no"</span>, <span class="st">"yes"</span>),</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">gender =</span> <span class="fu">factor</span>(</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>      gender, </span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"female"</span>, <span class="st">"male"</span>), </span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">location =</span> <span class="fu">factor</span>(</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>      location, </span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Rural"</span>, <span class="st">"Urban"</span>),</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># make missing the reference category in agent trust</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">agent_trust =</span> <span class="fu">relevel</span>(<span class="fu">as.factor</span>(agent_trust), <span class="at">ref =</span> <span class="st">"missing"</span>)</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(agent_trust, <span class="st">"-97"</span>))<span class="ot">-&gt;</span> model_data</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(model_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 6%">
<col style="width: 26%">
<col style="width: 8%">
<col style="width: 5%">
<col style="width: 11%">
<col style="width: 15%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">hhid</th>
<th style="text-align: left;">mm_account_cancelled</th>
<th style="text-align: left;">gender</th>
<th style="text-align: right;">age</th>
<th style="text-align: left;">location</th>
<th style="text-align: left;">agent_trust</th>
<th style="text-align: right;">agent_trust_missing</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1001</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">32</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">no</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">1002</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">32</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">no</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1003</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">30</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">no</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">1004</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">68</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">no</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1005</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: right;">28</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">no</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">1006</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: right;">36</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">missing</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>In R, logistic regression uses the <code>glm()</code> function where we apply R’s formula interface as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>logistic_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> mm_account_cancelled <span class="sc">~</span> age <span class="sc">+</span> gender <span class="sc">+</span> location <span class="sc">+</span> agent_trust <span class="sc">+</span> <span class="dv">0</span>,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> model_data,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(logistic_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = mm_account_cancelled ~ age + gender + location + 
    agent_trust + 0, family = "binomial", data = model_data)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.8391  -0.6019  -0.4077  -0.3078   2.5756  

Coefficients:
                 Estimate Std. Error z value      Pr(&gt;|z|)    
age             0.0004951  0.0057476   0.086      0.931351    
gender0        -0.9063038  0.2654006  -3.415      0.000638 ***
gender1        -1.6289007  0.2838453  -5.739 0.00000000954 ***
location1      -0.9743810  0.2781764  -3.503      0.000460 ***
agent_trustno  -0.8437161  0.1793917  -4.703 0.00000256109 ***
agent_trustyes -1.4101772  0.4397230  -3.207      0.001341 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1669.10  on 1204  degrees of freedom
Residual deviance:  934.48  on 1198  degrees of freedom
AIC: 946.48

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">as.numeric</span>(<span class="fu">as.character</span>(model_data<span class="sc">$</span>mm_account_cancelled)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1486711</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">tidy</span>(logistic_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">age</td>
<td style="text-align: right;">0.0004951</td>
<td style="text-align: right;">0.0057476</td>
<td style="text-align: right;">0.0861455</td>
<td style="text-align: right;">0.9313507</td>
</tr>
<tr class="even">
<td style="text-align: left;">gender0</td>
<td style="text-align: right;">-0.9063038</td>
<td style="text-align: right;">0.2654006</td>
<td style="text-align: right;">-3.4148523</td>
<td style="text-align: right;">0.0006382</td>
</tr>
<tr class="odd">
<td style="text-align: left;">gender1</td>
<td style="text-align: right;">-1.6289007</td>
<td style="text-align: right;">0.2838453</td>
<td style="text-align: right;">-5.7386924</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">location1</td>
<td style="text-align: right;">-0.9743810</td>
<td style="text-align: right;">0.2781764</td>
<td style="text-align: right;">-3.5027447</td>
<td style="text-align: right;">0.0004605</td>
</tr>
<tr class="odd">
<td style="text-align: left;">agent_trustno</td>
<td style="text-align: right;">-0.8437161</td>
<td style="text-align: right;">0.1793917</td>
<td style="text-align: right;">-4.7032048</td>
<td style="text-align: right;">0.0000026</td>
</tr>
<tr class="even">
<td style="text-align: left;">agent_trustyes</td>
<td style="text-align: right;">-1.4101772</td>
<td style="text-align: right;">0.4397230</td>
<td style="text-align: right;">-3.2069669</td>
<td style="text-align: right;">0.0013414</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(model_data<span class="sc">$</span>mm_account_cancelled)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
   0    1 
1025  179 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>model_data <span class="sc">%&gt;%</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prob =</span> <span class="fu">predict</span>(logistic_model, <span class="at">type =</span> <span class="st">"response"</span>),</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">pred =</span> <span class="fu">if_else</span>(prob <span class="sc">&gt;</span> <span class="fl">0.1486711</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">%&gt;%</span> </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">accuracy =</span> <span class="fu">mean</span>(mm_account_cancelled <span class="sc">==</span> pred)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">accuracy</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.532392</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>